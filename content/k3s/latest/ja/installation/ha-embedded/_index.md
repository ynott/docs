---
title: "組み込みDB(試験実装)による高可用性"
weight: 40
---

v 1.0.0では、K3sは外部データベースを必要とせずに高可用性コントロールプレーンを実行するためのプレビューをサポートしています。つまり、信頼性の高い本番グレードのセットアップを実行するために、外部etcdやSQLデータストアを管理する必要はありません。この機能は現在試験的なものですが、将来的にはHA K3sクラスタを実行するための主要なアーキテクチャになると考えられます。

このアーキテクチャは、K3sサーバプロセス内にdqliteデータベースを組み込むことで実現します。DQLiteは"分散SQLite"の略で、https://dqlite.io によると「*堅牢なIoTデバイスやEdgeデバイスに最適なRaftのコンセンサスによる高速で埋め込み型の永続的SQLデータベース*」とのことです。K3sで利用することはとても自然な流れです。

このモードでK3sを実行するには、奇数のサーバーノードが必要です。3つのノードから開始することをお勧めします。

まず、追加のサーバをクラスタに追加するための共有シークレットキーとして使用されるトークンを定義して、`cluster-init` フラグを付けてクラスタ化を有効にした状態でサーバノードを起動します。
```
K3S_TOKEN=SECRET k3s server --cluster-init
```

最初のサーバーを起動した後、共有シークレットを使用して2番目と3番目のサーバーをクラスターに参加させます:
```
K3S_TOKEN=SECRET k3s server --server https://<ip or hostname of server1>:6443
```

これで、高可用性のコントロールプレーンができました。後の追加のワーカーノードをクラスタに追加する手順は、単一サーバークラスタと同じになります。

